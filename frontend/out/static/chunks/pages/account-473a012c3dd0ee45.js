(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7966],{93290:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account",function(){return t(38486)}])},90479:function(e,n,t){"use strict";t.d(n,{Z:function(){return x}});var r=t(34051),s=t.n(r),a=t(85893),i=t(83866),o=t(83078),c=t(50041),u=t(25009),d=t(67294),l=t(8433),f=t(31955);function p(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(u){return void t(u)}o.done?n(c):Promise.resolve(c).then(r,s)}function h(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){p(a,r,s,i,o,"next",e)}function o(e){p(a,r,s,i,o,"throw",e)}i(void 0)}))}}function x(e){var n=e.nftAddress,t=e.tokenId,r=e.isVisible,p=e.urbEAuctionAddress,x=e.onClose,v=e.nftId,b=e.seller,m=(0,o.Nr)(),w=m.isWeb3Enabled,g=m.account,k=(0,i.lm)(),y=(0,o.JX)().runContractFunction,N=f.Z.get("csrftoken"),j=(0,d.useState)(0),E=j[0],A=j[1],S=(0,d.useState)(null),C=S[0],I=S[1],P=(0,o.JX)({abi:c,contractAddress:p,functionName:"getListing",params:{nftAddress:n,tokenId:t}}).runContractFunction;function F(e){return _.apply(this,arguments)}function _(){return(_=h(s().mark((function e(n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x&&x(),e.next=4,n.wait();case 4:if(1!==e.sent.status){e.next=23;break}return k({type:"success",title:"Bid Placed!",position:"topR"}),(t=new FormData).append("bidPrice",E),t.append("bidder",g),t.append("nftId",v),e.prev=11,e.next=14,l.Z.post("/",t,{headers:{"Content-Type":"multipart/form-data","X-CSRFToken":N}});case 14:e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),console.error(e.t0);case 20:A("0"),e.next=24;break;case 23:console.error("Transaction failed"),k({type:"error",title:"Transaction failed",position:"topR"});case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(0),console.error(e.t1),k({type:"error",title:"Transaction failed",position:"topR"});case 30:case"end":return e.stop()}}),e,null,[[0,26],[11,17]])})))).apply(this,arguments)}function T(){return(T=h(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E>C)){e.next=6;break}return r={abi:c,contractAddress:p,functionName:"placeBid",msgValue:E,params:{nftAddress:n,tokenId:t}},e.next=4,y({params:r,onError:function(e){console.log(e)},onSuccess:function(e){return F(e)}});case 4:e.next=7;break;case 6:console.log("Price too low!");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,d.useEffect)((function(){if(w){function e(){return r.apply(this,arguments)}function r(){return(r=h(s().mark((function e(){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(n,t);case 2:r=e.sent,a=r.price,I(a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e()}}),[w]),(0,a.jsxs)(i.u_,{isVisible:r&&g.toLowerCase()!==b.toLowerCase(),onCancel:x,onCloseButtonPressed:x,width:"400px",onOk:function(){return T.apply(this,arguments)},children:[E<=C&&E>0&&(0,a.jsx)("div",{className:"mb-5 text-red-600",children:"Price too low."}),(0,a.jsx)(i.II,{label:"Update listing price in L1 Currency (ETH)",name:"New listing price",type:"number",onChange:function(e){A(u.fi(e.target.value||"0"))}})]})}},69071:function(e,n,t){"use strict";t.d(n,{Fr:function(){return c},sU:function(){return d},t3:function(){return u}});var r=t(17283);function s(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function a(){var e=s(['\n    {\n        activeItems(first: 20, where: { winner: "0x0000000000000000000000000000000000000000" }) {\n            id\n            buyer\n            winner\n            nftAddress\n            tokenId\n            price\n        }\n    }\n']);return a=function(){return e},e}function i(){var e=s(["\n    query GetAccountNfts($account: String!, $deployer: String!) {\n        auctionEndeds(where: { winner: $account, winner_not: $deployer }) {\n            id\n            winner\n            seller\n            nftAddress\n            tokenId\n            price\n        }\n    }\n"]);return i=function(){return e},e}function o(){var e=s(["\n    query GetAccountNfts($seller: String!) {\n        auctionEndeds(where: { seller: $seller }) {\n            id\n            winner\n            seller\n            nftAddress\n            tokenId\n            price\n        }\n    }\n"]);return o=function(){return e},e}var c=(0,r.Ps)(a()),u=(0,r.Ps)(i()),d=(0,r.Ps)(o())},38486:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return A}});var r=t(34051),s=t.n(r),a=t(85893),i=t(5372),o=t(83866),c=t(69071),u=t(3056),d=t(83078),l=t(48036),f=t(67294),p=t(50041),h=t(34640),x=t(25675),v=t.n(x),b=t(25009),m=(t(90479),t(37918),t(16162)),w=t(8433);function g(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(u){return void t(u)}o.done?n(c):Promise.resolve(c).then(r,s)}function k(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){g(a,r,s,i,o,"next",e)}function o(e){g(a,r,s,i,o,"throw",e)}i(void 0)}))}}var y=function(e,n){if(e.length<=n)return e;var t=n-"...".length,r=Math.ceil(t/2),s=Math.floor(t/2);return e.substring(0,r)+"..."+e.substring(e.length-s)};function N(e){var n=e.price,t=e.nftAddress,r=e.tokenId,i=e.urbEAuctionAddress,c=e.sellerWinner,u=(0,d.Nr)(),l=u.chainId,x=u.isWeb3Enabled,g=(u.account,l?parseInt(l).toString():null),N=(0,f.useState)(""),j=N[0],E=N[1],A=(0,f.useState)(""),S=A[0],C=A[1],I=(0,f.useState)(""),P=(I[0],I[1]),F=(0,f.useState)(""),_=(F[0],F[1]),T=(0,f.useState)(""),W=(T[0],T[1]),X=(0,f.useState)(""),J=(X[0],X[1]),L=(0,f.useState)(null),O=(L[0],L[1],(0,f.useState)(!1)),R=(O[0],O[1],(0,f.useState)(!1)),$=(R[0],R[1],(0,f.useState)(!1)),H=$[0],U=$[1],B=((0,o.lm)(),(0,f.useContext)(m.P)),G=B.globalState,Z=(B.setGlobalState,(0,d.JX)({abi:h,contractAddress:t,functionName:"tokenURI",params:{tokenId:r}}).runContractFunction),D=(0,d.JX)({abi:p,contractAddress:i,functionName:"getDeployer",params:{}}).runContractFunction,M=(0,d.JX)({abi:p,contractAddress:i,functionName:"getListing",params:{nftAddress:t,tokenId:r}}).runContractFunction;(0,d.JX)({abi:p,contractAddress:i,functionName:"auctionEnd",params:{nftAddress:t,tokenId:r}}).runContractFunction;function V(){return(V=k(s().mark((function e(){var n,t,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:if(!(n=e.sent)){e.next=15;break}return t=n.replace("ipfs://","https://ipfs.io/ipfs/"),e.next=7,fetch(t);case 7:return e.next=9,e.sent.json();case 9:r=e.sent,a=r.image,i=a.replace("ipfs://","https://ipfs.io/ipfs/"),E(i),C(r.name),P(r.description);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,f.useEffect)((function(){x&&function(){V.apply(this,arguments)}()}),[x]),(0,f.useEffect)((function(){if(x){function e(){return n.apply(this,arguments)}function n(){return(n=k(s().mark((function e(){var n,a,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t,r);case 2:return n=e.sent,a=n.highestBidder,i=n.seller,e.next=7,D();case 7:o=e.sent,W(o),_(a),J(i);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e()}}),[x]);var q=function(){var e=k(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U(!H);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=k(s().mark((function e(){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=function(){return t.apply(this,arguments)},t=function(){return(t=k(s().mark((function e(){var n,t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.Z.get("/api/fetch-txHash/",{headers:{tokenId:r}});case 3:n=e.sent,(t=n.data.txHash)&&(a="","5"===g?a="https://goerli.etherscan.io/tx/".concat(t):"1"===g&&(a="https://etherscan.io/tx/".concat(t)),window.open(a,"_blank")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)},n();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,a.jsx)("div",{className:"m-2",children:j?(0,a.jsx)("div",{className:"group [perspective:400px] hover:scale-110 transition-all duration-500",children:(0,a.jsxs)("div",{onClick:q,className:"h-[410px] w-[250px] relative cursor-pointer rounded-3xl transition-all duration-500 [transform-style:preserve-3d] bg-white bg-opacity-50 dark:bg-slate-800 dark:bg-opacity-50 border-solid border border-gray-200 dark:border-gray-700 ".concat(H?"[transform:rotateY(180deg)]":"","  "),children:[(0,a.jsxs)("div",{className:"absolute h-full w-full p-5 dark:text-gray-300 [backface-visibility:hidden]",children:[(0,a.jsxs)("div",{className:" flex flex-col gap-2 ",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:["#",r]}),G.isStaff?(0,a.jsxs)("div",{className:"italic text-sm",children:["Winner: ",y(c||"",15)]}):(0,a.jsxs)("div",{className:"italic text-sm",children:["Sold by: ",y(c||"",15)]})]}),(0,a.jsx)("div",{className:"h-[250px] w-[200px]",children:(0,a.jsx)(v(),{loader:function(){return j},src:j,layout:"fill",objectFit:"contain"})}),(0,a.jsxs)("div",{className:"mt-5 font-bold self-end",children:[b.bM(n,"ether")," ETH"]})]}),(0,a.jsx)("div",{className:"flex justify-center mt-3 font-semibold text-lg text-sky-500",children:(0,a.jsx)("h2",{children:S})})]}),(0,a.jsx)("div",{className:"absolute h-full w-full p-5 flex justify-center transition duration-500 dark:text-gray-300 [transform:rotateY(180deg)] [backface-visibility:hidden]",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("button",{onClick:z,className:"btn btn-outline-primary px-3 py-1 rounded-xl border-2 font-semibold text-[14px] hover:scale-125 transition ease-out duration-500 border-green-600 dark:bg-green-600 text-slate-800",children:"Check Etherscan!"})})})]})}):(0,a.jsx)("div",{children:"Loading..."})})}function j(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(u){return void t(u)}o.done?n(c):Promise.resolve(c).then(r,s)}function E(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){j(a,r,s,i,o,"next",e)}function o(e){j(a,r,s,i,o,"throw",e)}i(void 0)}))}}function A(){var e=(0,d.Nr)(),n=e.chainId,t=e.isWeb3Enabled,r=e.account,h=n?parseInt(n).toString():null,x=n?l[h].UrbEAuction[0]:null,v=(0,d.JX)().runContractFunction,w=(0,o.lm)(),g=(0,f.useContext)(m.P),k=g.globalState,y=(g.setGlobalState,(0,f.useState)(null)),j=y[0],A=y[1],S=(0,f.useState)("0"),C=S[0],I=S[1],P=(0,d.JX)({abi:p,contractAddress:x,functionName:"getDeployer",params:{},onError:function(e){return console.log(e)}}).runContractFunction,F=(0,d.JX)({abi:p,contractAddress:x,functionName:"getProceeds",params:{seller:r},onError:function(e){return console.log(e)}}).runContractFunction;(0,f.useEffect)((function(){if(t){function e(){return n.apply(this,arguments)}function n(){return(n=E(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:n=e.sent,A(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e()}}),[t]);var _=(0,u.a)(c.t3,{pollInterval:5e3,variables:{account:r,deployer:j}}),T=_.loading,W=(_.error,_.data),X=(0,u.a)(c.sU,{pollInterval:5e3,variables:{seller:r}}),J=X.loading,L=(X.error,X.data);function O(){return(O=E(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:(n=e.sent)&&I(n.toString());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R=function(){w({type:"success",message:"Withdrawing proceeds",position:"topR"})};return(0,f.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[C,r,t,n]),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"border-4 border-solid border-green-600 rounded-2xl p-4 m-5 max-w-[1536px] flex flex-col transition-all duration-500 bg-white bg-opacity-25 dark:bg-slate-900 dark:bg-opacity-20 backdrop-blur-md",children:[k.isStaff?(0,a.jsx)("h1",{className:"mb-5 font-bold text-2xl",children:"Sold NFTs"}):(0,a.jsx)("h1",{className:"mb-5 font-bold text-2xl",children:"Owned NFTs"}),(0,a.jsx)("div",{className:"flex flex-row flex-wrap justify-center",children:k.isStaff?t&&n&&L?J?(0,a.jsx)("div",{children:"Loading..."}):L.auctionEndeds.length?L.auctionEndeds.map((function(e){var n=e.price,t=e.nftAddress,r=e.tokenId,s=e.winner;return x?(0,a.jsx)(N,{price:n,nftAddress:t,tokenId:r,urbEAuctionAddress:x,sellerWinner:s},"".concat(t).concat(r)):(0,a.jsx)("div",{children:"Network error, please switch to a supported network."})})):(0,a.jsx)("div",{children:"No NFTs sold"}):(0,a.jsx)("div",{children:"Web3 Currently Not Enabled"}):t&&n&&W?T?(0,a.jsx)("div",{children:"Loading..."}):W.auctionEndeds.length?W.auctionEndeds.map((function(e){var n=e.price,t=e.nftAddress,r=e.tokenId,s=e.seller;return x?(0,a.jsx)(N,{price:n,nftAddress:t,tokenId:r,urbEAuctionAddress:x,sellerWinner:s},"".concat(t).concat(r)):(0,a.jsx)("div",{children:"Network error, please switch to a supported network."})})):(0,a.jsx)("div",{children:"No NFTs owned"}):(0,a.jsx)("div",{children:"Web3 Currently Not Enabled"})})]}),(0,a.jsxs)("div",{className:"border-4 border-solid border-green-600 rounded-2xl p-4 m-5 self-center transition-all duration-500 bg-white bg-opacity-25 dark:bg-slate-900 dark:bg-opacity-20 backdrop-blur-md",children:[(0,a.jsx)("h1",{className:"mb-5 font-bold text-2xl",children:"Withdraw Proceeds"}),0!=C&&(0,a.jsxs)("div",{className:"mb-2",children:["Withdraw ",b.dF(C)," ETH"]}),"0"!=C?(0,a.jsx)(i.i,{theme:"outline",onClick:function(){v({params:{abi:p,contractAddress:x,functionName:"withdrawProceeds",params:{}},onError:function(e){return console.log(e)},onSuccess:function(){return R}})},text:"Withdraw",type:"button"}):(0,a.jsx)("div",{children:"No proceeds detected"})]})]})}}},function(e){e.O(0,[2025,8543,1333,9774,2888,179],(function(){return n=93290,e(e.s=n);var n}));var n=e.O();_N_E=n}]);